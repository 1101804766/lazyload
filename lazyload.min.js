/*!
 * author:jieyou
 * contacts:baidu hi->youyo1122
 * see https://github.com/jieyou/lazyload
 */
!function(a,b){function j(){}function k(c,d){var f;return f=d._$container==e?(b.innerHeight?b.innerHeight:e.height())+e.scrollTop():d._$container.offset().top+a(d.container).height(),f<=c.offset().top-d.threshold}function l(c,d){var f;return f=d._$container==e?e.width()+(a.fn.scrollLeft?e.scrollLeft():b.pageXOffset):d._$container.offset().left+a(d.container).width(),f<=c.offset().left-d.threshold}function m(a,b){var c;return c=b._$container==e?e.scrollTop():b._$container.offset().top,c>=a.offset().top+b.threshold+a.height()}function n(c,d){var f;return f=d._$container==e?a.fn.scrollLeft?e.scrollLeft():b.pageXOffset:d._$container.offset().left,f>=c.offset().left+d.threshold+c.width()}function o(a,b){var c=0;a.each(function(d){function g(){f.trigger("_lazyload_appear"),c=0}var f=a.eq(d);if(!b.skip_invisible||f.width()||f.height()||"none"===f.css("display"))if(b.vertical_only)if(m(f,b));else if(k(f,b)){if(++c>b.failure_limit)return!1}else g();else if(m(f,b)||n(f,b));else if(k(f,b)||l(f,b)){if(++c>b.failure_limit)return!1}else g()})}function p(a){return a.filter(function(b){return!a.eq(b)._lazyload_loadStarted})}var i,e=a(b),f={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:b,data_attribute:"original",skip_invisible:!0,appear:j,load:j,vertical_only:!1,minimum_interval:300,use_minimum_interval_in_ios:!1,url_rewriter_fn:j,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"},g=/(?:iphone|ipod|ipad).*os/gi.test(navigator.appVersion),h=g&&/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion);i=function(){var a=Object.prototype.toString;return function(b){return a.call(b).replace("[object ","").replace("]","")}}(),a.fn.lazyload=function(c){var k,l,m,q,d=this,n=null;return a.isPlainObject(c)||(c={}),a.each(["threshold","failure_limit","minimum_interval"],function(a,b){"String"==i(c[b])&&(c[b]=parseInt(c[b],10))}),a.each(f,function(a,b){!f.hasOwnProperty(a)||c.hasOwnProperty(a)&&i(c[a])==i(f[a])||(c[a]=b)}),k=c._$container=c.container&&c.container!=b?a(c.container):e,delete c.container,l="scroll"==c.event,m=l||"scrollstart"==c.event||"scrollstop"==c.event,d.each(function(b){var f=this,g=d.eq(b),h=g.attr("src"),i=g.attr("data-"+c.data_attribute),k=c.url_rewriter_fn==j?i:c.url_rewriter_fn.call(f,g,i),l=g.is("img");return 1==g._lazyload_loadStarted||h==k?(g._lazyload_loadStarted=!0,d=p(d),void 0):(g._lazyload_loadStarted=!1,l&&!h&&g.one("error",function(){g.attr("src",c.placeholder_real_img)}).attr("src",c.placeholder_data_img),g.one("_lazyload_appear",function(){var e,b=a.isArray(c.effect_params);g._lazyload_loadStarted||(e="show"!=c.effect&&a.fn[c.effect]&&(!c.effect_params||b&&0==c.effect_params.length),c.appear!=j&&c.appear.call(f,d.length,c),g._lazyload_loadStarted=!0,a("<img />").one("load",function(){e&&g.hide(),l?g.attr("src",k):g.css("background-image",'url("'+k+'")'),e&&g[c.effect].apply(g,b?c.effect_params:[]),d=p(d),c.load!=j&&c.load.call(f,d.length,c)}).attr("src",k))}),m||g.on(c.event,function(){g._lazyload_loadStarted||g.trigger("_lazyload_appear")}),void 0)}),m&&(q=0!=c.minimum_interval,k.on(c.event,function(){return!l||!q||g&&!c.use_minimum_interval_in_ios?o(d,c):(n||(n=setTimeout(function(){o(d,c),n=null},c.minimum_interval)),void 0)})),e.on("resize load",function(){o(d,c)}),h&&e.on("pageshow",function(a){a.originalEvent&&a.originalEvent.persisted&&d.trigger("_lazyload_appear")}),a(function(){o(d,c)}),this}}(window.jQuery||window.Zepto,window,document);