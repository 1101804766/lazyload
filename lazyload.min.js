/*!
 * author:jieyou
 * contacts:baidu hi->youyo1122
 * see https://github.com/jieyou/lazyload
 */
;(function(j,l,n,g){var e=j(l),h={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:l,data_attribute:"original",skip_invisible:true,appear:null,load:null,vertical_only:false,minimum_interval:300,use_minimum_interval_in_ios:false,url_rewriter_fn:k,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"},m=(/(?:iphone|ipod|ipad).*os/gi).test(navigator.appVersion),d=m&&(/(?:iphone|ipod|ipad).*os 5/gi).test(navigator.appVersion);function k(){}function c(p,r){var q;if(r.container===g||r.container===l){q=(l.innerHeight?l.innerHeight:e.height())+e.scrollTop()}else{q=r._$container.offset().top+j(r.container).height()}return q<=p.offset().top-r.threshold}function o(p,r){var q;if(r.container===g||r.container===l){q=e.width()+(j.fn.scrollLeft?e.scrollLeft():l.pageXOffset)}else{q=r._$container.offset().left+j(r.container).width()}return q<=p.offset().left-r.threshold}function i(p,r){var q;if(r.container===g||r.container===l){q=e.scrollTop()}else{q=r._$container.offset().top}return q>=p.offset().top+r.threshold+p.height()}function b(p,r){var q;if(r.container===g||r.container===l){q=j.fn.scrollLeft?e.scrollLeft():l.pageXOffset}else{q=r._$container.offset().left}return q>=p.offset().left+r.threshold+p.width()}function a(r,q){var p=0;r.each(function(u,v){var s=r.eq(u);if(q.skip_invisible&&!(s.width()||s.height())&&s.css("display")!=="none"){return}function t(){s.trigger("_lazyload_appear");p=0}if(q.vertical_only){if(i(s,q)){}else{if(!c(s,q)){t()}else{if(++p>q.failure_limit){return false}}}}else{if(i(s,q)||b(s,q)){}else{if(!c(s,q)&&!o(s,q)){t()}else{if(++p>q.failure_limit){return false}}}}})}function f(p){return p.filter(function(q,r){return !r._lazyload_loadStarted})}j.fn.lazyload=function(r){var t=this,v,q,p,u=null,s;if(!j.isPlainObject(r)){r={}}j.each(h,function(x,w){if(h.hasOwnProperty(x)&&(!r.hasOwnProperty(x)||(typeof(r[x])!=typeof(h[x])))){r[x]=w}});v=r._$container=(r.container===g||r.container===l)?e:j(r.container);q=r.event=="scroll";p=q||r.event=="scrollstart"||r.event=="scrollstop";t.each(function(A,C){var z=this,y=t.eq(A),x=y.attr("src"),D=y.attr("data-"+r.data_attribute),w=r.url_rewriter_fn==k?D:r.url_rewriter_fn.call(z,y,D),B=y.is("img");if(z._lazyload_loadStarted==true||x==w){z._lazyload_loadStarted=true;t=f(t);return}z._lazyload_loadStarted=false;if(B&&!x){y.on("error",function(){y.attr("src",r.placeholderRealImg)}).attr("src",r.placeholderDataImg)}y.one("_lazyload_appear",function(){var F,E=j.isArray(r.effect_params),G;if(!z._lazyload_loadStarted){G=(r.effect!="show"&&j.fn[r.effect]&&(!r.effect_params||(E&&r.effect_params.length==0)));if(r.appear){F=t.length;r.appear.call(z,F,r)}z._lazyload_loadStarted=true;j("<img />").on("load",function(){var H;if(G){y.hide()}if(B){y.attr("src",w)}else{y.css("background-image",'url("'+w+'")')}if(G){y[r.effect].apply(y,E?r.effect_params:[])}t=f(t);if(r.load){H=t.length;r.load.call(z,H,r)}}).attr("src",w)}});if(!p){y.on(r.event,function(){if(!z._lazyload_loadStarted){y.trigger("_lazyload_appear")}})}});if(p){s=typeof(r.minimum_interval)=="number"&&r.minimum_interval!=0;v.on(r.event,function(){if(q&&s&&(!m||r.use_minimum_interval_in_ios)){if(!u){u=setTimeout(function(){a(t,r);u=null},r.minimum_interval)}}else{return a(t,r)}})}e.on("resize load",function(){a(t,r)});if(d){e.on("pageshow",function(w){if(w.originalEvent&&w.originalEvent.persisted){t.trigger("_lazyload_appear")}})}j(function(){a(t,r)});return this}})(window.jQuery||window.Zepto,window,document);